!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).RF=e()}(this,(function(){"use strict";return class{__functions=new Map;constructor(t={"http:":"ws://","https:":"wss://"}[location.protocol]+window.location.host+"/"){this.__wsURI=t}connect(){return new Promise(((t,e)=>{this.__socket=new WebSocket(this.__wsURI),this.__readyIndicator={resolve:t,reject:e},this.__socket.onmessage=t=>{t=JSON.parse(t.data.toString()),this.__dispatch(t.type,t.data)},this.__awaiting={}}))}__dispatch(t,e){({availableFuncs:()=>{e.forEach((t=>{this[t]=(...e)=>this.__callFunc(t,e)})),this.__readyIndicator&&(this.__readyIndicator.resolve(),delete this.__readyIndicator)},functionResult:()=>{this.__awaiting[e.reqId]&&(this.__awaiting[e.reqId][e.resultType](e.result),delete this.__awaiting[e.reqId])},error:()=>{console.error(e)},callClientFunc:()=>{let{id:t,args:i}=e,s=this.__functions.get(t);s&&s(...i)}})[t]()}__send(t,e){this.__socket.send(JSON.stringify({type:t,data:e}))}__callFunc(t,e){return new Promise(((i,s)=>{let r=Math.random().toString(16).substr(2);this.__send("callFunc",{fname:t,args:this.__serializeArgs(e),reqId:r}),this.__awaiting[r]={resolve:i,reject:s}}))}__serializeArgs(t){return t.map(this.__serializeArg)}__serializeArg=t=>{let e=this,i={object:()=>({type:"object",data:e.__serializeObject(t)}),function:function(){return{type:"function",data:e.__registerFunction(t)}}}[typeof t];return i?i():t};__serializeObject(t){return Object.entries(t).map(((t,e)=>this.__serializeArg(e))).reduce(((t,e)=>({...t,[e[0]]:e[1]})),{})}__registerFunction(t){let e,i=Array.from(this.__functions.entries()).find((e=>{let[,i]=e;return t==i}));return i?[e]=i:(e=Math.random().toString(16).substr(2),this.__functions.set(e,t)),e}}}));
